<!DOCTYPE html>
<html>
  <head>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
      rel="stylesheet"
    />
  </head>

  <script type="module">
    const tableData = "assertions_json.json";
    const FILES = [
      { relativePath: tableData, type: "fetch" },
      { relativePath: "assertions.log", type: "embed" },
      { relativePath: "execution.log", type: "fetch" },
      { relativePath: ".meta", type: "fetch" },
    ];

    const HEADERS = [
      {
        header: "ID",
        path: "id",
        width: "4%",
      },
      {
        header: "Title",
        path: "title",
        width: "40%",
      },
      {
        header: "Status",
        path: "status",
        width: "6%",

        fn: (data) => {
          const span = document.createElement("b");
          span.title = data;
          span.style.color = data === "Success" ? "green" : "red";
          span.style.fontSize = "2em";
          span.style.filter = "drop-shadow(2px 1px 2px)";
          span.innerHTML = data === "Success" ? "&#10004;" : "&#10008;";
          return span;
        },
      },
      {
        header: "Hard Failure",
        path: "hardFaliure",
        width: "6%",
        fn: (data) => (data ? "Yes" : "No"),
      },
      {
        header: "Remark",
        path: "remark",
        width: "20%",
      },
      {
        header: "Output",
        path: "output",
        accordion: true,
        width: "15%",
      },

      {
        header: "Expected",
        path: "expected",
        accordion: true,
        width: "15%",
      },
      {
        header: "Screenshot",
        path: "screenshotPath",
        type: "image",
        width: "20%",
      },
      {
        header: "Diff File",
        path: "diffFilePath",
        accordion: true,
        width: "20%",
      },
      {
        header: "Output File",
        path: "outputFilePath",
        accordion: true,
        width: "20%",
      },
      {
        header: "Expected File",
        path: "expectedFilePath",
        accordion: true,
        width: "20%",
      },
      {
        header: " ",
        width: "4%",
        type: "node",
        defaultValue: "Open",
        fn: function (method, index) {
          const btn = document.createElement("button");
          btn.onclick = () => method(btn);
          // console.log(this);
          btn.innerText = btn.innerText === ">" ? "<" : ">";
          btn.id = `acd-btn-${index}`;
          btn.classList.add("btn");
          btn.style.transform = "rotate(90deg)";
          // btn.style.rotate(90)

          return btn;
        },
      },
    ];

    async function readFileData() {
      const data = {};
      const itemsToFetch = FILES.filter((value) => value.type === "fetch");
      const resp = await Promise.all(
        itemsToFetch.map(async (value) => {
          return await fetch("http://127.0.0.1:9999/" + value.relativePath)
            .then((response) =>
              value.relativePath.includes("json") ||
              value.relativePath.includes("meta")
                ? response.json()
                : response.text()
            )
            .catch((error) => console.error(error));
        })
      );
      itemsToFetch.map((value, index) => {
        data[value.relativePath] = resp[index];
      });
      return data;
    }

    const renderTable = (data) => {
      const tableEl = document.getElementById("table");
      const columns = HEADERS.filter((value) => !value?.accordion);

      tableEl.appendChild(generateHeaders(columns));
      const accordionColumns = HEADERS.filter((value) => value?.accordion);
      generateDataCells(
        columns,
        data,
        tableEl,
        HEADERS.filter((value) => value?.accordion)
      );
    };

    const loadAccordion = (data, columns, id) => {
      const box = document.createElement("div");
      box.id = id;
      box.style.display = "none";
      box.style.padding = "5px";
      const newColumns = [{ width: "5%" }, ...columns];
      box.appendChild(generateHeaders(newColumns));
      generateDataCells(newColumns, data, box);

      return box;
    };

    const generateDataCells = (headers, data, tableEl, accordionData = []) => {
      data.map((value, index) => {
        const row = document.createElement("div");
        row.classList.add("grid");
        row.style.gridTemplateColumns =
          headers.map((value) => value.width).join(" ") + "\n" + "100%";
        const accordionId = accordionData && `accordion-${index + 1}`;
        headers.map((header) => {
          const item = document.createElement("div");

          if (Object.keys(header).length > 1) {
            let data = index + 1;
            if (header.path !== "id") {
              data = value[header.path];
            }

            if (header.type === "image") {
              data = data.split(`\\`);
              data = data[data.length - 1];
              const img = document.createElement("img");
              img.src = data;
              // img.width = "100";
              // img.height = "100";
              img.classList.add("hover-affect");
              img.onclick = () => {
                const a = document.createElement("a");
                a.href = data;
                a.target = "_blank";
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
              };
              if (data.trim() != "") {
                item.appendChild(img);
              } else {
                const p = document.createElement("p");
                p.innerText = "NA";
                item.appendChild(p);
              }
            } else if (header.type === "node") {
              item.appendChild(
                header.fn((btn) => {
                  const acd = document.getElementById(accordionId);
                  acd.style.display =
                    btn.innerText === ">" ? "initial" : "none";
                  // btn.innerText = btn.innerText === "Open" ? "Close" : "Open";
                  btn.innerText = btn.innerText === ">" ? "<" : ">";
                  btn.style.transform = "rotate(90deg)";
                }, index)
              );
            } else {
              if (header.fn) {
                item.append(header.fn(data));
              } else {
                item.innerText = data;
                item.title = data;
              }
            }
            item.classList.add("cell");
          }
          row.appendChild(item);
        });
        const main = document.createElement("div");

        main.appendChild(row);
        if (accordionData.length > 0) {
          main.classList.add("row-accordion");

          const accordion = loadAccordion([value], accordionData, accordionId);
          accordion.onclick = () => {};
          main.appendChild(accordion);
        }

        tableEl.appendChild(main);
      });
    };

    const generateHeaders = (headers) => {
      const headDivEl = document.createElement("div");
      headDivEl.classList.add("grid");

      headDivEl.style.gridTemplateColumns = headers
        .map((value) => value.width)
        .join(" ");

      headers.forEach(({ header }, index) => {
        const headEl = document.createElement("div");
        if (header) {
          headEl.innerHTML = header;
          headEl.id = `head-${index + 1}`;
          headEl.classList.add("cell", "header");
        }
        headDivEl.appendChild(headEl);
      });

      return headDivEl;
    };

    const loadPieChart = (data, colors) => {
      const pieSection = document.getElementById("pie-chart-section");
      let pie = document.createElement("div");
      let legend = document.createElement("div");

      pie.className = "pie";
      legend.className = "legend";
      pieSection.appendChild(pie);
      pieSection.appendChild(legend);

      const segments = {};

      let total = 0;
      data.forEach(({ status }) => {
        if (!Object.keys(segments).includes(status.toLowerCase())) {
          segments[status.toLowerCase()] = 0;
        }
        segments[status.toLowerCase()] += 1;
        total += 1;
      });

      let from = 0,
        to = 0;
      const segmentArea = [];
      for (let s of Object.entries(segments)) {
        to = from + Math.ceil((s[1] / total) * 360);
        if (to > 360) {
          to = 360;
        }
        segmentArea.push(`${colors[s[0]]} ${from}deg ${to}deg`);
        from = to;
        let row = document.createElement("div");
        row.className = "row";
        row.innerHTML = `<div class='legend-row' style=background:${
          colors[s[0]]
        }></div><div class="legend-text">${s[0]} </div><div>(${s[1]})</div>`;
        legend.appendChild(row);
      }

      pie.style.cssText = `background: conic-gradient(${segmentArea.join(
        ","
      )})`;
    };

    const main = async () => {
      const data = (await readFileData()) || [];
      renderTable(data[tableData]);
      const executionLogPage = data["execution.log"];
      const executionLogs = data["execution.log"].split("\n");
      const meta = data[".meta"];
      // get folder for title using screenshot save path
      let executionTitle = executionLogs[6].split(" ");
      executionTitle = executionTitle[executionTitle.length - 1];
      const path = data[tableData][0].screenshotPath.split("\\");
      let ping = executionLogs[3];
      if (ping.includes("Ping")) {
        ping = ping.split(" ");
        ping = parseFloat(ping[ping.length - 1]);
      } else {
        ping = undefined;
      }
      executionTitle = executionTitle[executionTitle.length - 1];

      loadPieChart(data[tableData], {
        success: "#399918",
        failure: "#FF7777",
        ["assertion failed"]: "#FF7777",
        ["not diff"]: "#FF7777",
      });
      const metaStartIndex = executionLogs.findIndex((value) =>
        value.includes("METADATA START")
      );
      const metaEndIndex = executionLogs.findIndex((value) =>
        value.includes("METADATA END")
      );
      // console.log(metaStartIndex + 2, metaEndIndex - metaStartIndex - 2)

      loadMetaData(
        executionLogs
          .splice(metaStartIndex + 1, metaEndIndex - metaStartIndex - 1)
          .map((value) => {
            const data = value.split(":-")[1].split(": ");
            return {
              header: data[0],
              value: data[1],
            };
          })
      );
      loadMetaData([
        {
          header: "Tenant",
          value: meta?.browser?.url,
        },
        {
          header: "Tenant Version",
          value:
            (meta?.tanent?.['window.GIT_BRANCH']) +
            " (" +
            (meta?.tanent?.['window.OQTON_APP_VERSION'] ) +
            ")"
        },
      ]);
      loadHeader(executionLogs[0].split(":-")[1].split(","));
      loadExecutionLog(executionLogPage);

      const menu = document.getElementById("menu");
      const div = document.getElementById("print-btn");
      const btn = document.createElement("button");
      btn.innerHTML = "&#128438;";
      btn.id = "printBTN";
      btn.title = "NOTE: CTRL+Click to print expanded report";
      btn.onclick = () => {
        document.getElementById("myForm").style.display = "flex";
      };
      btn.classList.add("btn");
      btn.style.width = "100px";
      div.appendChild(btn);

      document.getElementById("report").style.display = "block";

      div.onclick = () => {
        // var active_tab = document.getElementsByClassName("active-menu")[0].textContent;
        // // console.log(active_tab[0].textContent)
        // var ss = document.getElementById("photo-grid");
        // if (active_tab == "Screenshots"){
        //   ss.style.height="100%"
        // }
        // else{
        //   ss.style.height="80vh"
        // }
      };
    };

    const navReport = document.getElementById("report-btn");
    const navExecution = document.getElementById("execution-btn");
    const navScreenshot = document.getElementById("screenshots-btn");

    navReport.onclick = () => {
      document.getElementById("report").style.display = "block";
      document.getElementById("execution").style.display = "None";
      document.getElementById("screenshots").style.display = "None";

      navReport.classList.add("active-menu");
      navExecution.classList.remove("active-menu");
      navScreenshot.classList.remove("active-menu");
    };

    navExecution.onclick = () => {
      document.getElementById("report").style.display = "None";
      document.getElementById("execution").style.display = "block";
      document.getElementById("screenshots").style.display = "None";

      navReport.classList.remove("active-menu");
      navExecution.classList.add("active-menu");
      navScreenshot.classList.remove("active-menu");
    };

    navScreenshot.onclick = () => {
      document.getElementById("report").style.display = "None";
      document.getElementById("execution").style.display = "None";
      document.getElementById("screenshots").style.display = "flex";

      navReport.classList.remove("active-menu");
      navExecution.classList.remove("active-menu");
      navScreenshot.classList.add("active-menu");
    };

    const loadExecutionLog = (data) => {
      let data1 = data;
      // console.log(data1)
      const log = document.getElementById("execution-log");
      const pre = document.createElement("pre");
      pre.textContent = data1;
      pre.style.whiteSpace = "break-spaces";
      pre.style.wordBreak = "break-spaces";
      log.appendChild(pre);
      // for (let i = 0; i < data1.length; i++) {
      //   const span = document.createElement("span");
      //   console.log(data1[i])
      //   span.textContent = data1[i];
      //   span.innerHTML += '<br>';
      //   // if (i < data1.length - 1) {
      //   // span.innerHTML += '<br>'; // Optional: Adds line break between spans
      //   // }
      //   log.appendChild(span);
      // }
    };

    const loadHeader = (data) => {
      const title = document.getElementById("app-title");
      const version = document.getElementById("app-version");
      title.innerText = data[0];
      version.innerText = data[1];
    };

    const loadMetaData = (data) => {
      const metaDataEl = document.getElementById("metadata");
      data.map(({ header, value }) => {
        if (value != undefined){
          const h4 = document.createElement("h4");
          h4.innerText = header + ":";
          h4.style.marginRight = "10px";
          const span = document.createElement("span");
          span.innerText = value;
          // span.style.textOverflow = "ellipsis";
          // span.style.overflow = "hidden";
          span.title = value;
          metaDataEl.append(h4, span);
        }
      });
    };

    window.onload = main;

    const getSS = await fetch("http://127.0.0.1:9999/screenshots")
      .then((response) => response.text())
      .then((data) => {
        // Create a DOM parser to parse the directory listing
        let parser = new DOMParser();
        let doc = parser.parseFromString(data, "text/html");

        // Find all links to images
        let images = doc.querySelectorAll("a");

        var imageNames = [];
        images.forEach((link) => {
          imageNames.push(link.text);
        });
        // console.log(imageNames)
        return imageNames;
      })
      .catch((error) => console.error("Error fetching images:", error));

    const loadScreenshots = () => {
      var photoGrid = document.getElementById("photo-grid");
      if (getSS.length > 0) {
        getSS.forEach((element) => {
          // console.log(element)
          const img = document.createElement("img");
          img.src = "/screenshots/" + element;
          photoGrid.appendChild(img);
        });
      } else {
        navScreenshot.style.display = "None";
      }
    };
    loadScreenshots();

    const act_prt_btn = document.getElementById("act_prt_btn");
    act_prt_btn.onclick = () => {
      print_rpt(false);
    };

    const act_prt_det_btn = document.getElementById("act_prt_det_btn");
    act_prt_det_btn.onclick = () => {
      print_rpt(true);
    };

    const print_rpt = (details) => {
      add_signoff_details();
      document.getElementById("myForm").style.display = "none";
      const buttons = document.querySelectorAll('button[id^="acd-btn-"]');
      const prt_btn = document.getElementById("printBTN");

      menu.style.display = "none";
      var ss = document.getElementById("photo-grid");
      ss.style.height = "100%";

      buttons.forEach((button) => {
        if (details) {
          button.onclick();
        }
        button.style.display = "none";
      });

      prt_btn.style.display = "none";
      window.print();
      prt_btn.style.display = "initial";

      buttons.forEach((button) => {
        if (details) {
          button.onclick();
        }
        button.style.display = "initial";
      });
      menu.style.display = "flex";
      ss.style.height = "80vh";
    };

    const add_signoff_details = () => {
      const sign_off = document.getElementById("sign-off");
      sign_off.replaceChildren();

      var data = [];
      // const ver = document.getElementById("ver");
      const by = document.getElementById("by");
      const comment = document.getElementById("comment");

      if(by.value != ""){
        data.push({ header: "Verified By", value: by.value });
        data.push({ header: "Comment", value: comment.value });
      }
    

      // data.push({ header: "Tested Version", value: ver.value });
     

      data.map(({ header, value }) => {
        const outerspan = document.createElement("span");
        outerspan.classList.add("sign_off_outer_span");
        const h4 = document.createElement("h4");
        h4.innerText = header + ":";
        h4.style.marginRight = "10px";
        const span = document.createElement("span");
        span.innerText = value;
        span.title = value;
        outerspan.append(h4, span);
        sign_off.append(outerspan);
      });
    };

    const modal = document.getElementById("myForm");
    const modalContainer = document.querySelector(".form-container");

    window.onclick = function (event) {
      if (event.target === modal) {
        modal.style.display = "None";
      }
    };
  </script>
  <style>
    @page {
      size: landscape;
      margin: 4mm 0 4mm 0;
    }
    :root {
      --padding: 10px;
      --rounded: 5px;
      --box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px;
      overflow-wrap: anywhere;
    }
    body {
      min-width: 100%;
      max-height: fit-content;
      overflow: auto;
      margin: 0;
      font-family: "centrano2", sans-serif;
      background-color: rgb(248, 247, 246);
    }

    #metadata-section {
      width: 60%;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      padding: var(--padding);
      border-left: 1px solid gray;
      margin-left: 8px;
      @media (max-width: 720px) {
        width: 65%;
        margin-left: 4px !important;
      }
    }

    #metadata {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      align-items: center;
    }

    #metadata h4 {
      margin: 8px;
    }
    .legend-text {
      white-space: nowrap;
    }
    #title-section {
      display: flex;
      flex-direction: column;
    }

    .hover-affect:hover {
      filter: opacity(50%);
    }

    #table-section {
      table {
        border-collapse: collapse;
        border-spacing: 10px 10px;
        border-radius: 6px;
      }
      .cell {
        border: 1px solid #00000040;
        padding: 5px;
        text-align: center;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .cell > img {
        object-fit: cover;
        width: 100%;
        height: 100%;
      }
      .header {
        font-weight: bold;
      }
    }

    .rounded-shadow-div {
      box-shadow: var(--box-shadow);
      padding: var(--padding);
      margin: 15px 0px;

      border-radius: var(--rounded);
    }
    .item-row {
      border: 1px solid black;
    }

    #table-title {
      width: 100%;
      font-size: 30px;
      font-weight: bold;
      text-align: center;
    }

    .legend-row {
      height: 20px;
      width: 20px;
      border-radius: 30px;
      margin-right: 5px;
    }

    .row-accordion {
      margin-bottom: 0.5em;
      border: 1px solid #00000040;
      transition: all 2s;
    }

    /* Pie chart Styling  */
    .pie {
      width: 50%;
      height: auto;
      aspect-ratio: 1/1;
      border-radius: 50%;
      margin-right: 10%;
      filter: drop-shadow(0px 0px 8px black);
      box-shadow: inset 0px 0px 74px -19px;
    }
    .legend {
      top: 0px;
      right: 0px;
      display: grid;
      grid-template-columns: 1;
      margin: 10px;
    }

    .row {
      display: grid;
      grid-template-columns: auto auto auto;
      align-items: center;
      width: fit-content;
      margin-bottom: 10px;
    }

    .legend .color {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      margin-right: 5px;
      width: fit-content;
    }

    #pie-chart-section {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
      width: 50%;
      height: 100%;
      box-shadow: 0px 0px 8px -4px black;
      padding: 20px 0;
      border-radius: 8px;
      @media (max-width: 768px) {
        width: 35%;
        flex-direction: column;
      }
    }

    #table-title {
      text-overflow: ellipsis;
      overflow: hidden;
      width: 50%;
    }

    .align-row-center {
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
    }

    .grid {
      display: grid;
    }
    .btn {
      background-color: #478ccf;
      border-radius: var(--rounded);
      border: none;
      height: 50px;
      color: white;
      font-weight: 800;
      font-size: medium;
    }
    .btn:hover {
      cursor: pointer;
    }

    #insight {
      display: flex;
      flex-direction: row;
      height: fit-content;
      justify-content: space-between;
      align-items: center;
      @media (max-width: 768px) {
        flex-direction: row;
      }
    }

    #logo {
      display: flex;
      flex-direction: row;
      justify-content: flex-start;
      align-items: center;
      filter: drop-shadow(0 6px 4px gray);
      /* width: 50%; */
    }

    #menu {
      width: 50%;
      display: flex;
      justify-content: center;
      flex-direction: row;
    }

    #menu span {
      padding: 0 1rem;
    }

    #menu span:hover {
      scale: calc(1.1);
    }

    #menu span {
      font-size: 20px;
      line-height: 16px;
      letter-spacing: 0.02em;
      text-decoration: none;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .active-menu {
      font-weight: 500;
      text-shadow: 0 1px 1px black;
    }

    #section-1-partition {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: space-between;
      border-radius: 12px;
      background-color: rgba(255, 255, 255, 0.1);
      border: 1px solid #ffffff20;
      backdrop-filter: blur(16px);
    }

    #app-detials {
      display: flex;
      flex-direction: column;
      width: 70%;
      justify-content: center;
    }

    #print-btn {
      display: flex;
      flex-direction: row;
      justify-content: flex-end;
      align-items: center;
      position: absolute;
      top: 7rem;
      right: 0.5rem;
      width: 50px;
    }

    #print-btn > .btn {
      color: black;
      font-size: 2em;
      box-shadow: 0px 0px 4px 1px gray;
    }

    #photo-grid {
      /* display: block; */
      width: 80vw;
      height: 80vh;
      /* grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            padding: 10px; */
    }
    #photo-grid > img {
      height: inherit;
      width: inherit;
      object-fit: contain;
      filter: drop-shadow(0 0 8px black);
      margin-bottom: 1em;
    }

    .hide-section {
      display: None;
    }

    /* The popup form - hidden by default */
    .form-popup {
      display: None;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 9;
      width: 100vw;
      height: 100vh;
      justify-content: center;
      align-items: center;
      background-color: #000000bb;
    }

    /* Add styles to the form container */
    .form-container {
      max-width: 50vw;
      background-color: white;
      padding: 1rem;
      border-radius: 0.5rem;
      animation: slideUp 0.4s ease;
    }

    /* Full-width input fields */
    .form-container input[type="text"],
    .form-container input[type="password"] {
      width: 95%;
      padding: 15px;
      margin: 5px 0 22px 0;
      border: none;
      border-radius: 0.5rem;
      background: #e6e5e5;
    }

    /* When the inputs get focus, do something */
    .form-container input[type="text"]:focus,
    .form-container input[type="password"]:focus {
      background-color: #ddd;
      outline: none;
    }

    /* Set a style for the submit/login button */
    .form-container .btn {
      background-color: #00928e;
      color: white;
      /* padding: 16px 20px; */
      border: none;
      cursor: pointer;
      width: 100%;
      margin: 10px;
      opacity: 0.8;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }

    /* Add a red background color to the cancel button */
    .form-container .cancel {
      background-color: #d2821b;
    }

    /* Add some hover effects to buttons */
    .form-container .btn:hover,
    .open-button:hover {
      opacity: 1;
    }

    #sign-off {
      display: flex;
      align-items: center;
      justify-content: space-around;
    }

    .sign_off_outer_span {
      display: flex;
      align-items: center;
    }
    .note {
      display: flex;
      justify-content: start;
    }

    /* Animation for popup */
    @keyframes fadeIn {
      0% {
        opacity: 0;
      }
      100% {
        opacity: 1;
      }
    }

    @keyframes slideUp {
      0% {
        transform: translateY(30px);
      }
      100% {
        transform: translateY(0);
      }
    }
  </style>
  <body>
    <div style="padding: var(--padding)">
      <!-- <section id="title-section" class="rounded-shadow-div"> -->
      <section id="title-section" class="rounded-shadow-div">
        <div id="section-1-partition">
          <span id="logo">
            <div style="width: 200px; margin-right: 10px">
              <svg
                preserveAspectRatio="xMidYMid meet"
                fill="black"
                viewBox="0 0 82 16"
                class="sc-ijDOKB cjjXLz"
              >
                <g>
                  <path
                    d="M8,16 C3.581722,16 5.41083001e-16,12.418278 0,8 C-5.41083001e-16,3.581722 3.581722,8.11624501e-16 8,0 C12.418278,-8.11624501e-16 16,3.581722 16,8 C15.9945749,12.4160289 12.4160289,15.9945749 8,16 Z M8,3.69230769 C5.62092723,3.69230769 3.69230769,5.62092723 3.69230769,8 C3.69230769,10.3790728 5.62092723,12.3076923 8,12.3076923 C10.3790728,12.3076923 12.3076923,10.3790728 12.3076923,8 C12.3076923,6.85752897 11.8538475,5.76185057 11.0459984,4.95400156 C10.2381494,4.14615254 9.14247103,3.69230769 8,3.69230769 Z"
                  ></path>
                  <path
                    d="M57.5238095,16 C53.1055315,16 49.5238095,12.418278 49.5238095,8 C49.5238095,3.581722 53.1055315,8.11624501e-16 57.5238095,0 C61.9420875,-8.11624501e-16 65.5238095,3.581722 65.5238095,8 C65.5183844,12.4160289 61.9398384,15.9945749 57.5238095,16 Z M57.5238095,3.69230769 C55.1447368,3.69230769 53.2161172,5.62092723 53.2161172,8 C53.2161172,10.3790728 55.1447368,12.3076923 57.5238095,12.3076923 C59.9028823,12.3076923 61.8315018,10.3790728 61.8315018,8 C61.8315018,6.85752897 61.377657,5.76185057 60.569808,4.95400156 C59.761959,4.14615254 58.6662806,3.69230769 57.5238095,3.69230769 Z"
                  ></path>
                  <path
                    d="M25.2885763,12.3088313 C22.5331899,12.3088313 20.3938257,9.5441476 21.3369606,6.56537626 C21.7358008,5.31877019 22.6845921,4.34093337 23.8941693,3.92988341 C26.7844599,2.95787624 29.467022,5.16273301 29.467022,8.00247041 C29.467022,9.45063805 28.932181,10.7339336 27.8732435,11.5152305 C27.8631221,11.5230333 27.8588673,11.5365607 27.8626221,11.5489993 C27.8663769,11.5614379 27.8773271,11.5700901 27.8899572,11.570598 L32.2725499,11.570598 C32.3089367,11.5711544 32.3423879,11.5500862 32.3585065,11.5164609 C32.8611138,10.4546353 33.0485469,9.26238856 33.0485469,8.00247041 C33.0448743,5.54703959 31.9492907,3.22882901 30.075703,1.71205288 C28.2021152,0.195276758 25.7572842,-0.352680237 23.4417033,0.225182662 C20.6128487,0.907180698 18.4040435,3.18360429 17.7423034,6.0990589 C17.1816052,8.48552685 17.7132858,11.0052018 19.185008,12.9361459 C20.6567301,14.8670899 22.9060811,15.9962127 25.2885763,15.9999978 L34.9694381,15.9999978 C34.9945831,16.0001917 35.0182606,15.9878164 35.0329658,15.9667944 C35.0476711,15.9457723 35.051581,15.9187098 35.0434563,15.8941843 L33.9116944,12.3924977 C33.8954119,12.34281 33.850359,12.3092208 33.7994733,12.3088313 L25.2885763,12.3088313 Z"
                  ></path>
                  <path
                    d="M48,0.124031008 C48,0.0555305737 47.9452927,0 47.8778077,0 L35.1698113,0 C35.1023264,0 35.047619,0.0555305737 35.047619,0.124031008 L35.047619,4.09302326 C35.047619,4.16152369 35.1023264,4.21705426 35.1698113,4.21705426 L39.3243486,4.21705426 C39.3918335,4.21705426 39.4465409,4.27258484 39.4465409,4.34108527 L39.4465409,15.875969 C39.4465409,15.9444694 39.5012482,16 39.5687332,16 L43.4788859,16 C43.5463708,16 43.6010782,15.9444694 43.6010782,15.875969 L43.6010782,4.34108527 C43.6010782,4.27258484 43.6557855,4.21705426 43.7232704,4.21705426 L47.8778077,4.21705426 C47.9452927,4.21705426 48,4.16152369 48,4.09302326 L48,0.124031008 Z"
                  ></path>
                  <path
                    d="M81.283208,16 L81.4035088,16 C81.469949,16 81.5238095,15.9444694 81.5238095,15.875969 L81.5238095,0.124031009 C81.5238095,0.0555305751 81.469949,1.44799766e-09 81.4035088,1.44799766e-09 L77.7944862,1.44799766e-09 C77.7280459,1.44799766e-09 77.6741855,0.0555305751 77.6741855,0.124031009 L77.6741855,7.9379845 C77.6746121,7.96195236 77.6613338,7.98393967 77.6402842,7.99412102 C77.6192345,8.00430237 77.5943465,8.00077544 77.5767419,7.98511628 L68.2702757,0.0831007766 C68.2059747,0.0293326557 68.1256983,-7.5258453e-06 68.0429073,1.44799764e-09 L67.9298246,1.44799764e-09 C67.8633843,1.44799764e-09 67.8095238,0.0555305751 67.8095238,0.124031009 L67.8095238,15.875969 C67.8095238,15.9444694 67.8633843,16 67.9298246,16 L71.5388471,16 C71.6052874,16 71.6591479,15.9444694 71.6591479,15.875969 L71.6591479,8.31007752 C71.658788,8.28613326 71.6718317,8.26411506 71.6926576,8.25351174 C71.7134836,8.24290842 71.7383698,8.24561502 71.7565915,8.26046512 L81.0642607,15.9168992 C81.1265733,15.9683425 81.2034167,15.9975082 81.283208,16 Z"
                  ></path>
                </g>
              </svg>
            </div>
          </span>
          <span id="menu">
            <span id="report-btn" class="active-menu">Report</span>
            <span id="execution-btn">Execution Log</span>
            <span id="screenshots-btn">Screenshots</span>
          </span>
          <span id="app-details">
            <div><h1 style="margin: 0" id="app-title"></h1></div>
            <span id="app-version">Ver: </span>
          </span>
        </div>
      </section>
      <div id="print-btn"></div>

      <section id="report" class="hide-section">
        <section id="insight" class="rounded-shadow-div">
          <section id="pie-chart-section"></section>
          <section id="metadata-section">
            <h3 style="text-align: center">Test Details</h3>
            <div id="metadata"></div>
          </section>
        </section>
        <section id="sign-off"></section>
        <section
          id="table-section"
          class="rounded-shadow-div"
          style="page-break-before: always"
        >
          <div class="align-row-center">
            <!-- <h4 id="table-title">Test Run</h4> -->
          </div>

          <div id="table"></div>

          <!-- <div class="align-row-center">
          <h4 id="table-title"></h4>
        </div>

        <div id="table"></div> -->
        </section>
      </section>

      <section
        class="rounded-shadow-div hide-section"
        style="page-break-before: always"
        id="execution"
      >
        <div class="align-row-center">
          <!-- <h4 id="table-title">Execution Logs</h4> -->
        </div>
        <div id="execution-log"></div>
      </section>

      <section
        class="rounded-shadow-div hide-section"
        style="
          page-break-before: always;
          overflow-y: auto;
          display: flex;
          justify-content: center;
          flex-direction: column;
          align-items: center;
          display: none;
        "
        id="screenshots"
      >
        <div class="align-row-center" style="width: 100%">
          <h4 id="table-title">Screenshots</h4>
        </div>
        <div id="photo-grid"></div>
      </section>
    </div>
    <div class="form-popup" id="myForm">
      <div class="form-container">
        <!-- <label for="ver"><b>MOS Version Tested</b></label>
        <input type="text" placeholder="Enter MOS Version" id="ver" required /> -->
        <div style="margin-left: 10px; margin-right: 10px">
          <h1>Sign Off Report</h1>
          <label for="by"><b>Verified By</b></label>
          <input type="text" placeholder="Enter QA Name" id="by" required />

          <label for="comment"><b>Comments</b></label>
          <input
            type="text"
            placeholder="Enter comments"
            id="comment"
            required
          />

          <span class="note">Note: use Edge browser only</span>
        </div>
        <div style="display: flex; justify-content: center">
          <button id="act_prt_btn" class="btn">Print</button>
          <button id="act_prt_det_btn" type="button" class="btn cancel">
            Print with Details
          </button>
        </div>
      </div>
    </div>
  </body>
</html>
